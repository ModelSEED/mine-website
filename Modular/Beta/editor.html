<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>Marvin JS Examples - Demo</title>
	<script src="js/lib/rainbow/rainbow-custom.min.js"></script>
	<script src="bower_components/jquery/dist/jquery.min.js"></script>
	<script src="js/promise-0.1.1.min.js"></script>
	<script src="js/marvinjslauncher.js"></script>
	<script>

		var marvinController,
			inputController;

		$(document).ready(function handleDocumentReady (e) {
			MarvinJSUtil.getEditor("#sketch").then(function (sketcherInstance) {
				marvinController = new MarvinControllerClass(
					sketcherInstance
				);

				inputController = new InputControllerClass(

					$("#btn-molExport")
				);

			}, function () {
				alert("Cannot retrieve sketcher instance from iframe");
			});
			//alert(caffeineSource)
			//$("#molsource-box").val(caffeineSource);
		});

		var InputControllerClass = (function () {

			var delay = 5;

			function InputControllerClass (	molExportButton ) {
				this.setReactButton	= molExportButton;
				this.setReactButton.on("click", $.proxy(this.handleMolExportBtnClick, this));
			}

	
			InputControllerClass.prototype.handleMolExportBtnClick = function handleMolExportBtnClick (e) {
				this.delayCall(exportMolAction, ["mol"]);
			};



			InputControllerClass.prototype.delayCall = function delayCall (method, args) {
				setTimeout(function () {
					method.apply(null, args);
				}, delay);
			};

			

			return InputControllerClass;

		}());

		var MarvinControllerClass = (function () {

			function MarvinControllerClass ( sketcherInstance) {
				this.sketcherInstance 	= sketcherInstance;
			}
			return MarvinControllerClass;
		}());

		function exportMolAction (format) {	
			var exportPromise = marvinController.sketcherInstance.exportStructure(format, null);
			exportPromise.then(function(source) {
				alert(source);
			}, function(error) {
				alert(error);
			});
		}

	</script>
</head>
<body>
<div class="container">
   
    				<iframe src="editorws.html" id="sketch" class="sketcher-frame" width = "600" height = "600"></iframe>
  
    
		    
		<div class="molecule-div">
			<ul class="horizontalmenu">
				<li>
				
				
				
				</li>
				<li>&nbsp;</li>
				
				<li><input type="button" id="btn-molExport" value="Export"></input></li>
			</ul>
			
			</div>

  
			
			


    <div>
</body>
</html>
